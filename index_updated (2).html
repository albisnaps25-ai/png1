
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Profile — Enhanced Media Viewers</title>
    <style>
        :root {
            --bg: #f9fafb;
            --fg: #111827;
            --accent: #2563eb;
            --muted: #6b7280;
            --radius: 20px;
            --color-white: #fff;
            --color-black: #000;
            --color-red-400: #ff5252;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
        }
        body { 
            margin: 0; 
            background: var(--bg); 
            color: var(--fg); 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 0 16px; 
        }

        /* Header Styles - FIXED */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px;
            background-color: #ffffff;
            border-bottom: 1px solid #dbdbdb;
            position: sticky;
            top: 0;
            z-index: 100;
            box-sizing: border-box;
        }
        .hamburger {
            cursor: pointer;
            padding: 10px;
            position: relative;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 44px;
            width: 44px;
        }
        .hamburger div {
            width: 25px;
            height: 3px;
            background-color: #262626;
            margin: 2.5px 0;
            transition: all 0.3s ease;
        }
        .hamburger.active div:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger.active div:nth-child(2) {
            opacity: 0;
        }
        .hamburger.active div:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        .title {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            padding: 0;
            line-height: 1.2;
        }
        
        /* Compact Navigation Menu */
        .menu {
            position: fixed;
            top: 50px;
            right: 20px;
            width: 180px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            visibility: hidden;
            z-index: 999;
            padding: 10px 0;
        }
        .menu.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            visibility: visible;
        }
        .menu ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .menu ul li {
            margin: 0;
        }
        .menu ul li a {
            display: block;
            padding: 12px 20px;
            text-decoration: none;
            color: #333;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .menu ul li a:hover {
            background-color: #f0f0f0;
        }
        .menu-close {
            display: none;
        }

        /* Profile Section */
        .profile { 
            text-align: center; 
            padding: 1rem; 
        }
        .profile-pic-wrapper { 
            position: relative; 
            display: inline-block; 
        }
        .profile-pic-wrapper.has-story {
            position: relative;
            padding: 4px;
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            border-radius: 50%;
        }
        .profile-pic-wrapper.has-story .profile-pic {
            border: 3px solid var(--bg);
            position: relative;
            z-index: 1;
        }
        .profile img.profile-pic { 
            width: 120px; 
            height: 120px; 
            border-radius: 50%; 
            object-fit: cover; 
            cursor: pointer; 
            display: block; 
        }
        .creator-name { 
            font-size: 1.5rem; 
            font-weight: 600; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: .3rem; 
            margin-top: .5rem; 
        }
        .verified { 
            color: var(--accent); 
            font-size: 1.2rem; 
        }
        .username { 
            color: var(--muted); 
            margin-bottom: .5rem; 
        }
        .stats { 
            display: flex; 
            justify-content: center; 
            gap: 2rem; 
            margin: 1rem 0; 
        }
        .stat strong { 
            display: block; 
            font-size: 1.2rem; 
        }
        .actions { 
            display: flex; 
            gap: .8rem; 
            justify-content: center; 
            margin-bottom: 1rem; 
        }
        .actions button { 
            flex: 1; 
            padding: .8rem 1.2rem; 
            border-radius: var(--radius); 
            border: 0; 
            cursor: pointer; 
            font-weight: 600; 
            font-size: 1.1rem; 
        }
        .subscribe { 
            background: var(--accent); 
            color: white; 
        }
        .message { 
            background: #e5e7eb; 
        }
        .donate { 
            background: #facc15; 
        }

        /* Tabs */
        .tabs { 
            display: flex; 
            justify-content: center; 
            gap: 1.5rem; 
            margin: 1.5rem 0; 
            border-bottom: 2px solid #e5e7eb; 
            padding-bottom: 0.5rem; 
        }
        .tab-btn { 
            background: none; 
            border: none; 
            padding: .6rem 1.2rem; 
            cursor: pointer; 
            font-weight: 600; 
            color: var(--muted); 
            font-size: 1.1rem; 
        }
        .tab-btn.active { 
            color: var(--accent); 
            border-bottom: 3px solid var(--accent); 
        }
        
        /* Content Sections */
        .content {
            display: none;
            margin: 2rem 0;
        }
        .content.active {
            display: block;
        }
        
        /* Instagram-like Post Card */
        .post-card {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            background: #fff;
            margin-bottom: 20px;
        }

        .image-wrap {
            position: relative;
            width: 100%;
            aspect-ratio: 4/5;
            overflow: hidden;
        }

        .post-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* Header that covers the top part of the image */
        .image-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            padding: 8px 12px;
            gap: 10px;
            box-sizing: border-box;
            border-bottom: 1px solid #ddd;
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .post-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            border-top: 1px solid #eee;
            background: #fff;
        }

        .download-btn {
            background: #7b2cbf;
            color: #fff;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }
        
        /* Photo grid adjustments */
        .photos-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Reels grid adjustments - NEW OVERLAY SYSTEM */
        .reels-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 500px;
            margin: auto;
        }
        .reel-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 9/16;
            background: #000;
            border-radius: var(--radius);
            overflow: hidden;
        }
        .reel-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .reel-overlay {
            position: absolute;
            inset: 0;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 16px;
            pointer-events: none;
            transition: opacity 0.3s ease;
            opacity: 0.7;
        }
        .reel-user {
            color: #fff;
            font-weight: 600;
            font-size: 14px;
            text-shadow: 0 1px 3px rgba(0,0,0,.8);
            margin-top: 8px;
        }
        .reel-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: auto;
            align-self: flex-end;
        }
        .reel-like, .reel-comment, .reel-donate {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(0,0,0,.45);
            color: #fff;
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            border: none;
            cursor: pointer;
        }
        .reel-like:hover, .reel-comment:hover, .reel-donate:hover {
            background: rgba(0,0,0,.65);
            transform: scale(1.1);
        }
        .reel-like svg, .reel-comment svg, .reel-donate svg {
            width: 24px;
            height: 24px;
            fill: #fff;
            stroke: #fff;
        }
        .reel-like.liked svg {
            fill: var(--color-red-400);
            stroke: var(--color-red-400);
        }
        
        /* Exclusive Content */
        .exclusive-content {
            padding: 20px;
            text-align: center;
            color: #8e8e8e;
        }

        /* Viewer Modals */
        .viewer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            z-index: 1000;
            flex-direction: column;
        }
        .viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 100%);
        }
        .viewer-username {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }
        .close-viewer {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: white;
        }
        .feed {
            flex: 1;
            overflow-y: auto;
            scroll-snap-type: y mandatory;
        }
        .post-view {
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            scroll-snap-align: start;
            position: relative;
        }
        .post-media {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .post-actions {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
        }
        .post-actions.overlay {
            position: absolute;
            bottom: 20px;
            right: 20px;
            flex-direction: column;
            gap: 10px;
            margin-top: 0;
        }
        .like-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: white;
            background: rgba(0, 0, 0, 0.5);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .like-btn.liked {
            color: #ed4956;
        }
        .donate-btn {
            padding: 10px 20px;
            background-color: #0095f6;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }
        
        /* Username Overlay */
        .media-username {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
            z-index: 5;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px 15px;
            border-radius: 20px;
        }

        footer { 
            text-align: center; 
            margin: 2rem 0; 
            color: var(--muted); 
            font-size: .9rem; 
        }

        /* Chat - Updated for fixed header and footer */
        .chat-screen { 
            display: none; 
            flex-direction: column; 
            height: 100vh; 
            background: #fff; 
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
        }
        .chat-header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 12px 16px; 
            border-bottom: 1px solid #e5e7eb; 
            background: #fff; 
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10; 
            height: 64px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        }
        .chat-header-left { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            flex: 1;
        }
        .chat-header-left img { 
            width: 42px; 
            height: 42px; 
            border-radius: 50%; 
            object-fit: cover; 
        }
        .chat-user-info { 
            display: flex; 
            flex-direction: column; 
            line-height: 1.3; 
        }
        .chat-user-info strong { 
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 1px;
        }
        .online { 
            font-size: 13px; 
            color: #28a745;
            font-weight: 500;
        }
        .chat-header-right { 
            display: flex; 
            align-items: center; 
            gap: 16px; 
        }
        .chat-header button { 
            background: none; 
            border: none; 
            font-size: 20px; 
            cursor: pointer; 
            color: var(--fg);
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }
        .chat-header button:hover {
            background-color: #f0f0f0;
        }
        .chat-messages { 
            flex: 1; 
            overflow-y: auto; 
            padding: 24px 16px 24px 16px; 
            display: flex; 
            flex-direction: column; 
            gap: 6px; 
            background: #f8f9fa; 
            margin-top: 64px;
            margin-bottom: 72px;
            height: calc(100vh - 136px);
        }
        .msg-wrapper { 
            display: flex; 
            flex-direction: column; 
            align-items: flex-end; 
            margin-bottom: 2px;
            padding: 2px 8px;
        }
        .msg-wrapper:first-child {
            margin-top: 16px;
            padding-top: 8px;
        }
        .msg { 
            max-width: 75%; 
            padding: 12px 16px; 
            border-radius: 18px; 
            line-height: 1.4; 
            font-size: 15px; 
            word-wrap: break-word; 
            box-shadow: 0 1px 2px rgba(0,0,0,0.04);
        }
        .creator-msg { 
            background: #ffffff; 
            align-self: flex-start;
            border: 1px solid #e5e7eb;
            color: #1f2937;
        }
        .user-msg { 
            background: var(--accent); 
            color: white; 
        }
        .story-reply-msg {
            min-width: 220px;
            max-width: 85%;
        }
        .story-preview {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            margin-bottom: 8px;
            border-left: 3px solid #0095f6;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .story-preview:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .story-preview img {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .creator-msg .story-preview {
            background: rgba(0,0,0,0.08);
            border-left: 3px solid #666;
            border: 1px solid rgba(0,0,0,0.1);
        }
        .creator-msg .story-preview:hover {
            background: rgba(0,0,0,0.12);
        }
        .creator-msg .story-preview img {
            border: 2px solid rgba(0,0,0,0.1);
        }
        .seen { 
            font-size: 12px; 
            color: var(--muted); 
            margin-top: 4px; 
            margin-right: 4px;
            font-weight: 500;
        }
        .typing { 
            font-size: 14px; 
            color: var(--muted); 
            font-style: italic; 
            margin: 8px 0;
            padding: 12px 16px;
            background: #ffffff;
            border-radius: 18px;
            align-self: flex-start;
            border: 1px solid #e5e7eb;
        }
        .chat-input { 
            display: flex; 
            align-items: center; 
            padding: 12px 16px; 
            border-top: 1px solid #e5e7eb; 
            background: white; 
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10;
            height: 72px;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.04);
        }
        .chat-input input { 
            flex: 1; 
            padding: 12px 18px; 
            border: 1px solid #d1d5db; 
            border-radius: 24px; 
            outline: none; 
            font-size: 15px;
            background: #f8f9fa;
            transition: all 0.2s ease;
        }
        .chat-input input:focus {
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        .chat-input button { 
            background: none; 
            border: none; 
            font-size: 20px; 
            margin-left: 12px; 
            cursor: pointer; 
            color: var(--accent);
            padding: 10px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        .chat-input button:hover {
            background: rgba(37, 99, 235, 0.1);
            transform: scale(1.05);
        }

        /* Subscription Modal */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.6); 
            justify-content: center; 
            align-items: center; 
        }
        #subscriptionModal .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            text-align: center;
            width: 90%;
            max-width: 320px;
            position: relative;
        }
        #subscriptionModal .close {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        #subscriptionModal .close:hover,
        #subscriptionModal .close:focus {
            color: black;
        }
        .subscription-options {
            margin-bottom: 20px;
            text-align: left;
        }
        .option {
            margin: 12px 0;
            padding: 8px;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .option input {
            margin-right: 10px;
        }
        #subscriptionModal .subscribe-btn {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }

        /* Donation modals */
        .modal-content { 
            background: #fff; 
            padding: 20px; 
            border-radius: 12px; 
            max-width: 420px; 
            width: 90%; 
            text-align: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
            position: relative; 
        }
        .modal-content h3 { 
            margin: 0 0 1rem; 
            font-size: 1.3rem; 
        }
        .close-x-button { 
            position: absolute; 
            top: 10px; 
            right: 15px; 
            font-size: 20px; 
            cursor: pointer; 
            background: none; 
            border: none; 
        }
        .modal-button { 
            padding: .8rem 1.4rem; 
            margin: .6rem; 
            border: none; 
            border-radius: 20px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            font-weight: 600; 
            color: white; 
        }
        .btc-button { 
            background: linear-gradient(45deg, #f7931a, #ffbf00); 
        }
        .paypal-button { 
            background: #0070ba; 
        }
        .back-button { 
            background: #f7931a; 
            color: white; 
            border: none; 
            border-radius: 20px; 
            padding: .8rem 1.4rem; 
            margin-top: .6rem; 
            cursor: pointer; 
            font-size: 1.1rem; 
        }
        .qr-code { 
            border: 2px solid #f7931a; 
            border-radius: 10px; 
            padding: 8px; 
            margin: 10px auto; 
            background: white; 
            width: 100%; 
            max-width: 200px; 
            display: block; 
        }
        .wallet-address-container { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            margin: 10px 0; 
            flex-wrap: wrap; 
            gap: 8px; 
        }
        .wallet-address { 
            word-break: break-all; 
            font-family: monospace; 
            font-size: 13px; 
            color: #444; 
            padding: 8px 10px; 
            background: #f1f1f1; 
            border-radius: 5px; 
            flex: 1; 
            text-align: center; 
        }
        .copy-button { 
            background: #28a745; 
            color: white; 
            padding: .8rem 1.4rem; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 1.1rem; 
        }
        .copy-button:hover { 
            background: #218838; 
        }
        .status-message { 
            font-size: 14px; 
            margin-top: 10px; 
            display: none; 
        }
        .status-success { 
            color: #28a745; 
        }
        .status-error { 
            color: #dc3545; 
        }
        .donate-button { 
            background: linear-gradient(45deg, #f7931a, #ffbf00); 
            color: white; 
            padding: .8rem 1.4rem; 
            border: none; 
            border-radius: 25px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            font-weight: bold; 
            margin-top: .6rem; 
            box-shadow: 0 4px 8px rgba(247, 147, 26, 0.3); 
        }

        /* Story modal */
        .story-modal { 
            display: none; 
            position: fixed; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.95); 
            z-index: 2000; 
            justify-content: center; 
            align-items: center; 
        }
        .story-container { 
            position: relative; 
            width: 100%; 
            height: 100%; 
            max-width: 420px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            overflow: hidden; 
            border-radius: 12px; 
            background: #000; 
        }
        .story-image { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            display: none; 
        }
        .story-image.active { 
            display: block; 
        }

        /* Story tap areas for navigation */
        .story-tap-left,
        .story-tap-right {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 50%;
            z-index: 80;
            cursor: pointer;
        }
        .story-tap-left {
            left: 0;
        }
        .story-tap-right {
            right: 0;
        }

        /* Story Header Styles */
        .story-header {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 70;
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }
        .story-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .story-profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #fff;
        }
        .story-user-details {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .story-username {
            color: #fff;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .story-verified {
            color: #1DA1F2;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .progress-bars { 
            position: absolute; 
            top: 80px; 
            left: 10px; 
            right: 10px; 
            height: 3px; 
            display: flex; 
            gap: 6px; 
            z-index: 50; 
        }
        .progress-bar { 
            flex: 1; 
            height: 100%; 
            background: rgba(255,255,255,0.25); 
            border-radius: 2px; 
            overflow: hidden; 
        }
        .progress-bar-fill { 
            height: 100%; 
            background: #fff; 
            width: 0%; 
        }
        .story-count { 
            position: absolute; 
            top: 84px; 
            left: 14px; 
            color: #fff; 
            font-size: 12px; 
            background: rgba(0,0,0,0.45); 
            padding: 6px 8px; 
            border-radius: 12px; 
            z-index: 60; 
        }
        .btn { 
            background: transparent; 
            border: 0; 
            width: 64px; 
            height: 64px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            z-index: 60; 
            font-size: 28px; 
        }
        .close-btn { 
            position: absolute; 
            top: 24px; 
            right: 24px; 
            width: 40px; 
            height: 40px; 
            font-size: 18px; 
            line-height: 40px; 
            text-align: center; 
            background: rgba(0,0,0,0.6); 
            border-radius: 50%; 
            color: #fff; 
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .close-btn svg {
            pointer-events: none;
        }
        .close-btn * {
            pointer-events: none;
        }
        .nav-btn { 
            position: absolute; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(0,0,0,0.6); 
            border-radius: 50%; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            z-index: 60; 
            color: #fff; 
        }
        .nav-btn.visible { 
            display: flex; 
        }
        .nav-btn-left { 
            left: 14px; 
        }
        .nav-btn-right { 
            right: 14px; 
        }
        .story-controls { 
            position: absolute; 
            bottom: 28px; 
            left: 50%; 
            transform: translateX(-50%); 
            display: flex; 
            gap: 14px; 
            width: 92%; 
            align-items: center; 
            z-index: 60; 
        }
        .reply-input { 
            flex: 1; 
            background: rgba(255,255,255,0.12); 
            border: 1px solid rgba(255,255,255,0.15); 
            border-radius: 22px; 
            padding: 14px 18px; 
            color: #fff; 
            outline: none; 
            font-size: 1rem; 
        }
        .reply-input::placeholder { 
            color: rgba(255,255,255,0.7); 
        }
        .send-btn { 
            display: none; 
            background: rgba(0,0,0,0.5); 
            border: 0; 
            color: #fff; 
            width: 56px; 
            height: 56px; 
            border-radius: 50%; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            font-size: 24px; 
        }
        .send-btn.visible { 
            display: flex; 
        }
        .like-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 24px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s;
            z-index: 75;
        }
        .like-btn:hover {
            transform: scale(1.1);
        }
        .like-btn.liked {
            background: linear-gradient(45deg, #fa709a, #fee140);
        }

        /* New styles for SVG icons and interactive buttons */
        .post-stats {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .stat-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #555;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        .stat-btn:hover {
            background-color: #f0f0f0;
        }
        .stat-btn.liked {
            color: #ed4956;
        }
        .stat-btn .icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Comment Modal Styles */
        .comment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: flex-end;
        }
        
        .comment-container {
            background: white;
            width: 100%;
            max-width: 500px;
            height: 70vh;
            border-radius: 12px 12px 0 0;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .comment-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .comment-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }
        
        .comment-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 4px;
        }
        
        .comments-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px 20px;
        }
        
        .comment-item {
            margin-bottom: 16px;
            position: relative;
        }
        
        .comment-main {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        
        .comment-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }
        
        .comment-content {
            flex: 1;
            background: #f1f3f4;
            border-radius: 16px;
            padding: 8px 12px;
            position: relative;
        }
        
        .comment-author {
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .comment-text {
            font-size: 14px;
            line-height: 1.4;
        }
        
        .comment-actions {
            display: flex;
            gap: 16px;
            margin-top: 8px;
            margin-left: 48px;
            font-size: 12px;
            color: #666;
        }
        
        .comment-action {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            padding: 0;
        }
        
        .comment-action:hover {
            color: var(--accent);
        }
        
        .comment-action.liked {
            color: var(--color-red-400);
        }
        
        .comment-time {
            font-size: 12px;
            color: #999;
        }
        
        .comment-replies {
            margin-top: 12px;
            margin-left: 48px;
            border-left: 2px solid #e5e7eb;
            padding-left: 16px;
        }
        
        .reply-item {
            margin-bottom: 12px;
        }
        
        .reply-content {
            background: #f8f9fa;
        }
        
        .comment-input-container {
            padding: 12px 20px;
            border-top: 1px solid #e5e7eb;
            background: white;
        }
        
        .comment-input-wrapper {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }
        
        .comment-input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 14px;
            outline: none;
            resize: none;
            min-height: 36px;
            max-height: 100px;
        }
        
        .comment-input:focus {
            border-color: var(--accent);
        }
        
        .comment-send {
            background: var(--accent);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .comment-send:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .show-replies {
            color: var(--accent);
            font-size: 12px;
            font-weight: 600;
            background: none;
            border: none;
            cursor: pointer;
            margin-left: 48px;
            margin-top: 8px;
            padding: 4px 0;
        }
        
        .verified-comment {
            color: var(--accent);
            font-size: 12px;
        }
    </style>
</head>
<body>
    <!-- Header with Hamburger Menu - FIXED -->
    <div class="header">
        <div class="title">Sofia Creator</div>
        <div class="hamburger" onclick="toggleMenu()">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    
    <!-- Compact Navigation Menu -->
    <nav class="menu">
        <ul>
            <li><a href="#" onclick="switchTab('photos')">Home</a></li>
            <li><a href="#" onclick="switchTab('chat')">Chat</a></li>
            <li><a href="#" onclick="switchTab('support')">Support</a></li>
            <li><a href="#" onclick="switchTab('about')">About</a></li>
            <li><a href="#" onclick="toggleMenu()">Close</a></li>
        </ul>
    </nav>

    <div class="container main-screen">
        <section class="profile">
            <div class="profile-pic-wrapper has-story">
                <img id="profilePic" class="profile-pic" src="photo13.png" alt="Creator profile picture">
            </div>
            <div class="creator-name">Sofia Creator <span class="verified">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48" style="display:inline-block;">
                    <polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon>
                    <polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon>
                </svg>
            </span></div>
            <div class="username">@sofia123</div>
            <div class="stats">
                <div class="stat"><strong>15.2k</strong> Followers</div>
                <div class="stat"><strong>320k</strong> Likes</div>
            </div>
            <div class="actions">
                <button class="subscribe" onclick="openSubscribeModal()">Subscribe</button>
                <button class="message" id="openChat">Message</button>
                <button class="donate" id="openDonate">Donate</button>
            </div>
        </section>

        <div class="tabs">
            <button class="tab-btn active" data-tab="photos">Photos</button>
            <button class="tab-btn" data-tab="reels">Reels</button>
            <button class="tab-btn" data-tab="exclusive">Exclusive</button>
        </div>
        
        <!-- Photos Content -->
        <div id="photos-content" class="content active">
            <div class="photos-grid" id="photosGrid">
                <!-- Photos will be inserted here by JavaScript -->
            </div>
        </div>
        
        <!-- Reels Content -->
        <div id="reels-content" class="content">
            <div class="reels-grid" id="reelsGrid">
                <!-- Reels will be inserted here by JavaScript -->
            </div>
        </div>
        
        <!-- Exclusive Content -->
        <div id="exclusive-content" class="content">
            <div class="exclusive-content">
                <p>Subscribe to unlock exclusive content 
                    <svg style="width:16px;height:16px;display:inline-block;margin-left:4px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path>
                        <path d="M5 3v4"></path>
                        <path d="M19 17v4"></path>
                        <path d="M3 5h4"></path>
                        <path d="M17 19h4"></path>
                    </svg>
                </p>
                <div class="media-grid">
                    <img src="photo8.png" alt="Exclusive content locked">
                </div>
            </div>
        </div>
        
        <footer>&copy; <span id="year"></span> Sofia Creator</footer>
    </div>

    <!-- Photo Viewer Modal -->
    <div class="viewer-modal" id="photoViewerModal">
        <div class="viewer-header">
            <button class="close-viewer" onclick="closePhotoViewer()">×</button>
        </div>
        <div class="feed" id="photoFeed"></div>
    </div>

    <!-- Reel Viewer Modal -->
    <div class="viewer-modal" id="reelViewerModal">
        <div class="viewer-header">
            <button class="close-viewer" onclick="closeReelViewer()">×</button>
        </div>
        <div class="feed" id="reelFeed"></div>
    </div>

    <div id="chatScreen" class="chat-screen container">
        <div class="chat-header">
            <div class="chat-header-left">
                <button class="btn" id="backToMain">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="19" y1="12" x2="5" y2="12"></line>
                        <polyline points="12 19 5 12 12 5"></polyline>
                    </svg>
                </button>
                <img src="photo13.png" alt="Creator">
                <div class="chat-user-info">
                    <strong>Sofia Creator</strong>
                    <span class="online">Online</span>
                </div>
            </div>
            <div class="chat-header-right">
                <button title="Video Call">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="23 7 16 12 23 17 23 7"></polygon>
                        <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
                    </svg>
                </button>
                <button title="Voice Call">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                    </svg>
                </button>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input id="chatInput" placeholder="Message...">
            <button id="sendMessage">
                <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSubscribeModal()">&times;</span>
            <h2>Choose Your Subscription Plan</h2>
            <div class="subscription-options">
                <div class="option">
                    <input type="radio" id="basic" name="plan" value="basic" checked>
                    <label for="basic">Basic Plan - $4.99/month (Ad-supported access)</label>
                </div>
                <div class="option">
                    <input type="radio" id="premium" name="plan" value="premium">
                    <label for="premium">Premium Plan - $9.99/month (Ad-free, exclusive content)</label>
                </div>
                <div class="option">
                    <input type="radio" id="ultimate" name="plan" value="ultimate">
                    <label for="ultimate">Ultimate Plan - $19.99/month (Ad-free, exclusive content, early access, merchandise discounts)</label>
                </div>
            </div>
            <button class="subscribe-btn" onclick="subscribe()">Subscribe Now</button>
        </div>
    </div>

    <div id="chooseMethodModal" class="modal">
        <div class="modal-content">
            <button class="close-x-button" id="closeDonate">X</button>
            <h3>Choose Your Donation Method</h3>
            <div class="modal-buttons-container">
                <button class="modal-button btc-button" id="openBtcDonate">Donate with Bitcoin</button>
                <form action="https://www.paypal.com/donate" method="post" target="_blank" style="display:inline;">
                    <input type="hidden" name="business" value="YOUR_PAYPAL_EMAIL@EXAMPLE.COM"/>
                    <input type="hidden" name="currency_code" value="USD"/>
                    <input type="submit" class="modal-button paypal-button" value="Donate with PayPal"/>
                </form>
            </div>
        </div>
    </div>

    <div id="btcDonateModal" class="modal">
        <div class="modal-content">
            <button class="close-x-button" id="closeBtcDonate">X</button>
            <h3>Support Us with Bitcoin! 
                <svg style="width:18px;height:18px;display:inline-block;margin-left:4px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"></path>
                    <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"></path>
                    <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"></path>
                    <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"></path>
                </svg>
            </h3>
            <img id="qrCode" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=bc1q0ehvhyeaqnzj7apuk0a6d4ureayfl038cs8r6n" alt="BTC QR Code" class="qr-code">
            <p>Scan the QR code or copy the address below:</p>
            <div class="wallet-address-container">
                <div class="wallet-address" id="btcAddress">bc1q0ehvhyeaqnzj7apuk0a6d4ureayfl038cs8r6n</div>
                <button class="copy-button" id="copyBtcAddress">Copy</button>
            </div>
            <div id="statusMessage" class="status-message"></div>
            <button class="donate-button" id="donateBtcNow">Donate BTC Now</button>
            <button class="back-button" id="backToDonate">Back</button>
        </div>
    </div>

    <div id="storyModal" class="story-modal">
        <div class="story-container" id="storyContainer">
            <!-- Story Header with Profile Picture, Username, and Verified Badge -->
            <div class="story-header">
                <div class="story-user-info">
                    <img src="photo13.png" alt="Profile" class="story-profile-pic">
                    <div class="story-user-details">
                        <span class="story-username">Sofia Creator</span>
                        <span class="story-verified">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 48 48" style="display:inline-block;">
                                <polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon>
                                <polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon>
                            </svg>
                        </span>
                    </div>
                </div>
            </div>

            <div id="progressBars" class="progress-bars"></div>
            <div id="storyCount" class="story-count"></div>

            <!-- Story images -->
            <img src="photo10.png" class="story-image active" data-index="0" alt="Story 1">
            <img src="photo16.png" class="story-image" data-index="1" alt="Story 2">
            <img src="photo15.png" class="story-image" data-index="2" alt="Story 3">

            <!-- Invisible tap areas for navigation -->
            <div class="story-tap-left" id="storyTapLeft"></div>
            <div class="story-tap-right" id="storyTapRight"></div>

            <!-- Close button -->
            <button class="btn close-btn" id="storyCloseBtn">
                <svg style="width:18px;height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>

            <!-- Navigation -->
            <button class="btn nav-btn nav-btn-left" id="prevStoryBtn">
                <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <button class="btn nav-btn nav-btn-right" id="nextStoryBtn">
                <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                    <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
            </button>

            <!-- Controls -->
            <div class="story-controls">
                <input id="replyInput" class="reply-input" placeholder="Reply to this story">
                <button id="sendStoryBtn" class="send-btn">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
                <button id="likeStoryBtn" class="btn like-btn">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Comment Modal -->
    <div class="comment-modal" id="commentModal">
        <div class="comment-container">
            <div class="comment-header">
                <h3>Comments</h3>
                <button class="comment-close" id="closeComments">
                    <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="comments-list" id="commentsList">
                <!-- Comments will be dynamically added here -->
            </div>
            <div class="comment-input-container">
                <div class="comment-input-wrapper">
                    <textarea class="comment-input" id="commentInput" placeholder="Write a comment..." rows="1"></textarea>
                    <button class="comment-send" id="sendComment" disabled>
                        <svg style="width:16px;height:16px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPostId = null;
        let currentPostType = null;
        let replyingTo = null;

        // Comment system data
        const commentsData = {
            1: [
                {
                    id: 1,
                    author: "Emma Wilson",
                    avatar: "photo12.png",
                    text: "Amazing shot! The lighting is perfect 😍",
                    time: "2h",
                    likes: 12,
                    verified: false,
                    replies: [
                        {
                            id: 11,
                            author: "Sofia Creator",
                            avatar: "photo12.png",
                            text: "Thank you so much! 💕",
                            time: "1h",
                            likes: 5,
                            verified: true
                        }
                    ]
                },
                {
                    id: 2,
                    author: "Mike Johnson",
                    avatar: "photo11.png",
                    text: "Keep up the great work!",
                    time: "3h",
                    likes: 8,
                    verified: false,
                    replies: []
                }
            ],
            2: [
                {
                    id: 3,
                    author: "Sarah Davis",
                    avatar: "photo19.png",
                    text: "Love this content! 🔥",
                    time: "1h",
                    likes: 15,
                    verified: false,
                    replies: []
                }
            ]
        };

        function openCommentModal(postId, postType) {
            currentPostId = postId;
            currentPostType = postType;
            replyingTo = null;
            
            const modal = document.getElementById('commentModal');
            const commentsList = document.getElementById('commentsList');
            const commentInput = document.getElementById('commentInput');
            
            // Clear and populate comments
            commentsList.innerHTML = '';
            const comments = commentsData[postId] || [];
            
            comments.forEach(comment => {
                const commentElement = createCommentElement(comment);
                commentsList.appendChild(commentElement);
            });

        document.getElementById("year").textContent = new Date().getFullYear();
            
            // Show modal
            modal.style.display = 'flex';
            
            // Focus input after modal is shown
            setTimeout(() => {
                commentInput.focus();
            }, 300);
        }

        function createCommentElement(comment) {
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment-item';
            
            const avatarHTML = comment.avatar === "user-icon" ? 
                userIconSVG : 
                `<img src="${comment.avatar}" alt="${comment.author}" class="comment-avatar">`;
            
            commentDiv.innerHTML = `
                <div class="comment-main">
                    ${avatarHTML}
                    <div class="comment-content">
                        <div class="comment-author">
                            ${comment.author}
                            ${comment.verified ? '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 48 48" class="verified-comment"><polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon><polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon></svg>' : ''}
                        </div>
                        <div class="comment-text">${comment.text}</div>
                    </div>
                </div>
                <div class="comment-actions">
                    <button class="comment-action like-comment" data-comment-id="${comment.id}">
                        Like
                    </button>
                    <button class="comment-action reply-comment" data-comment-id="${comment.id}">
                        Reply
                    </button>
                    <span class="comment-time">${comment.time}</span>
                    ${comment.likes > 0 ? `<span class="comment-likes">${comment.likes} likes</span>` : ''}
                </div>
                ${comment.replies && comment.replies.length > 0 ? `
                    <div class="comment-replies">
                        ${comment.replies.map(reply => `
                            <div class="reply-item">
                                <div class="comment-main">
                                    ${reply.avatar === "user-icon" ? userIconSVG : `<img src="${reply.avatar}" alt="${reply.author}" class="comment-avatar">`}
                                    <div class="comment-content reply-content">
                                        <div class="comment-author">
                                            ${reply.author}
                                            ${reply.verified ? '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 48 48" class="verified-comment"><polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon><polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon></svg>' : ''}
                                        </div>
                                        <div class="comment-text">${reply.text}</div>
                                    </div>
                                </div>
                                <div class="comment-actions">
                                    <button class="comment-action like-comment" data-comment-id="${reply.id}">
                                        Like
                                    </button>
                                    <span class="comment-time">${reply.time}</span>
                                    ${reply.likes > 0 ? `<span class="comment-likes">${reply.likes} likes</span>` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
            
            return commentDiv;
        }

        function closeCommentModal() {
            const modal = document.getElementById('commentModal');
            modal.style.display = 'none';
            currentPostId = null;
            currentPostType = null;
            replyingTo = null;
            
            // Clear input
            const commentInput = document.getElementById('commentInput');
            commentInput.value = '';
            commentInput.placeholder = 'Write a comment...';
            updateSendButton();
        }

        function updateSendButton() {
            const commentInput = document.getElementById('commentInput');
            const sendButton = document.getElementById('sendComment');
            sendButton.disabled = !commentInput.value.trim();
        }

        function addComment() {
            const commentInput = document.getElementById('commentInput');
            const text = commentInput.value.trim();
            
            if (!text || !currentPostId) return;
            
            const newComment = {
                id: Date.now(),
                author: "You",
                avatar: "user-icon", // Use special identifier for icon
                text: text,
                time: "now",
                likes: 0,
                verified: false,
                replies: []
            };
            
            if (!commentsData[currentPostId]) {
                commentsData[currentPostId] = [];
            }
            
            if (replyingTo) {
                // Add as reply
                const parentComment = commentsData[currentPostId].find(c => c.id === replyingTo);
                if (parentComment) {
                    parentComment.replies.push(newComment);
                }
                replyingTo = null;
                commentInput.placeholder = 'Write a comment...';
            } else {
                // Add as main comment
                commentsData[currentPostId].unshift(newComment);
            }
            
            // Clear input and refresh comments
            commentInput.value = '';
            updateSendButton();
            openCommentModal(currentPostId, currentPostType);
        }

        // Event listeners
        document.getElementById('closeComments').onclick = closeCommentModal;
        document.getElementById('commentInput').oninput = updateSendButton;
        document.getElementById('commentInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                addComment();
            }
        });
        document.getElementById('sendComment').onclick = addComment;

        // Handle comment actions (like, reply)
        document.getElementById('commentsList').addEventListener('click', (e) => {
            if (e.target.classList.contains('like-comment')) {
                e.target.classList.toggle('liked');
                e.target.textContent = e.target.classList.contains('liked') ? 'Liked' : 'Like';
            } else if (e.target.classList.contains('reply-comment')) {
                const commentId = parseInt(e.target.dataset.commentId);
                const commentInput = document.getElementById('commentInput');
                
                replyingTo = commentId;
                commentInput.placeholder = 'Write a reply...';
                commentInput.focus();
            }
        });

        // SVG icons for various UI elements
        const heartIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>`;
        
        const commentIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>`;
        
        const giftIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 12 20 22 4 22 4 12"></polyline>
            <rect x="2" y="7" width="20" height="5"></rect>
            <line x1="12" y1="22" x2="12" y2="7"></line>
            <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
            <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
        </svg>`;

        const checkIcon = `<svg class="icon" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
        </svg>`;

        const messageIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"></path>
        </svg>`;

        const videoIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="23 7 16 12 23 17 23 7"></polygon>
            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
        </svg>`;

        const phoneIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
        </svg>`;

        const arrowLeftIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
        </svg>`;

        const arrowRightIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
        </svg>`;

        const sendIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>`;

        const closeIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>`;

        const sparklesIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path>
            <path d="M5 3v4"></path>
            <path d="M19 17v4"></path>
            <path d="M3 5h4"></path>
            <path d="M17 19h4"></path>
        </svg>`;

        const rocketIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"></path>
            <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"></path>
            <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"></path>
            <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"></path>
        </svg>`;

        const userIconSVG = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="width:36px;height:36px;background:#e5e7eb;border-radius:50%;padding:6px;color:#666;">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
        </svg>`;

        // Photo and Reel Data
        const photos = [
            { 
                id: 1, 
                url: 'photo16.png',
                likes: 124,
                comments: 32
            },
            { 
                id: 2, 
                url: 'photo18.png',
                likes: 89,
                comments: 21
            },
            { 
                id: 3, 
                url: 'photo15.png',
                likes: 156,
                comments: 43
            },
            { 
                id: 4, 
                url: 'photo10.png',
                likes: 201,
                comments: 56
            },
            { 
                id: 5, 
                url: 'photo14.png',
                likes: 167,
                comments: 38
            },
            { 
                id: 6, 
                url: 'photo17.png',
                likes: 142,
                comments: 29
            },
        ];

        const reels = [
            { 
                id: 1, 
                thumbnail: 'photo7.png', 
                url: 'reel1.mp4',
                likes: 215,
                comments: 47
            },
            { 
                id: 2, 
                thumbnail: 'photo9.png', 
                url: 'reel7.mp4',
                likes: 178,
                comments: 32
            },
            { 
                id: 3, 
                thumbnail: 'photo15.png', 
                url: 'reel8.mp4',
                likes: 243,
                comments: 61
            },
            { 
                id: 4, 
                thumbnail: 'photo10.png', 
                url: 'reel1.mp4',
                likes: 192,
                comments: 41
            },
            { 
                id: 5, 
                thumbnail: 'photo14.png', 
                url: 'reel7.mp4',
                likes: 165,
                comments: 28
            },
            { 
                id: 6, 
                thumbnail: 'photo17.png', 
                url: 'reel8.mp4',
                likes: 203,
                comments: 52
            },
        ];

        // Initialize photo and reel grids
        const photosGrid = document.getElementById('photosGrid');
        photos.forEach(photo => {
            const postCard = createPostCard(photo, 'photo');
            photosGrid.appendChild(postCard);
        });

        // Initialize reels with new system
        buildReels();

        // Function to create Instagram-style post card
        function createPostCard(item, type) {
            const postCard = document.createElement('div');
            postCard.className = 'post-card';
            
            // Image container
            const imageWrap = document.createElement('div');
            imageWrap.className = 'image-wrap';
            
            // Main image
            const img = document.createElement('img');
            img.className = 'post-image';
            img.src = type === 'photo' ? item.url : item.thumbnail;
            img.alt = type === 'photo' ? `Photo ${item.id}` : `Reel ${item.id}`;
            img.setAttribute('crossorigin', 'anonymous');
            img.setAttribute('data-image', type === 'photo' ? item.url : item.thumbnail);
            
            // Header with profile info
            const imageHeader = document.createElement('div');
            imageHeader.className = 'image-header';
            
            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            
            const avatarImg = document.createElement('img');
            avatarImg.src = 'photo13.png';
            avatarImg.alt = 'Profile avatar';
            
            avatar.appendChild(avatarImg);
            
            const username = document.createElement('div');
            username.className = 'username';
            username.innerHTML = '@sofia123 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="display:inline-block;margin-left:4px;vertical-align:middle;"><polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon><polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon></svg>';
            
            imageHeader.appendChild(avatar);
            imageHeader.appendChild(username);
            
            imageWrap.appendChild(img);
            imageWrap.appendChild(imageHeader);
            
            // Footer with stats and download button
            const postFooter = document.createElement('div');
            postFooter.className = 'post-footer';
            
            // Create stats container with SVG buttons
            const stats = document.createElement('div');
            stats.className = 'post-stats';
            
            // Like button with SVG
            const likeBtn = document.createElement('button');
            likeBtn.className = 'stat-btn';
            likeBtn.innerHTML = `${heartIcon} <span class="count">${item.likes}</span>`;
            likeBtn.onclick = (e) => {
                e.stopPropagation();
                likeBtn.classList.toggle('liked');
                const countSpan = likeBtn.querySelector('.count');
                if (likeBtn.classList.contains('liked')) {
                    countSpan.textContent = parseInt(countSpan.textContent) + 1;
                    // Update the SVG to filled heart
                    likeBtn.innerHTML = `<svg class="icon" viewBox="0 0 24 24" fill="#ed4956" stroke="#ed4956" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg> <span class="count">${countSpan.textContent}</span>`;
                } else {
                    countSpan.textContent = parseInt(countSpan.textContent) - 1;
                    // Revert to outline heart
                    likeBtn.innerHTML = `${heartIcon} <span class="count">${countSpan.textContent}</span>`;
                }
            };
            
            // Comment button with SVG
            const commentBtn = document.createElement('button');
            commentBtn.className = 'stat-btn';
            commentBtn.innerHTML = `${commentIcon} <span class="count">${item.comments}</span>`;
            commentBtn.onclick = (e) => {
                e.stopPropagation();
                openCommentModal(item.id, type);
            };
            
            // Donate button with SVG
            const donateBtn = document.createElement('button');
            donateBtn.className = 'stat-btn';
            donateBtn.innerHTML = `${giftIcon} Donate`;
            donateBtn.onclick = (e) => {
                e.stopPropagation();
                document.getElementById('openDonate').click();
            };
            
            stats.appendChild(likeBtn);
            stats.appendChild(commentBtn);
            stats.appendChild(donateBtn);
            
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'download-btn';
            downloadBtn.textContent = 'Download';
            downloadBtn.addEventListener('click', async (e) => {
                e.stopPropagation(); // Prevent opening the viewer
                const src = img.getAttribute('data-image') || img.src;
                try {
                    const res = await fetch(src, {mode:'cors'});
                    const blob = await res.blob();
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = type === 'photo' ? `photo-${item.id}.jpg` : `reel-${item.id}.jpg`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    URL.revokeObjectURL(url);
                } catch {
                    window.open(src, '_blank');
                }
            });
            
            postFooter.appendChild(stats);
            postFooter.appendChild(downloadBtn);
            
            postCard.appendChild(imageWrap);
            postCard.appendChild(postFooter);
            
            // Remove click event - photos are no longer clickable
            
            return postCard;
        }

        // NEW REELS SYSTEM - Build reels with autoplay and no click interactions
        function buildReels() {
            const grid = document.getElementById('reelsGrid');
            grid.innerHTML = ''; // Clear existing content
            
            reels.forEach(r => {
                const wrap = document.createElement('div');
                wrap.className = 'reel-wrapper';
                
                const video = document.createElement('video');
                video.className = 'reel-video';
                video.src = r.url;
                video.loop = true;
                video.poster = r.thumbnail;
                video.playsinline = true;
                video.muted = true;
                video.autoplay = false; // Will be controlled by intersection observer
                
                const overlay = document.createElement('div');
                overlay.className = 'reel-overlay';
                
                const user = document.createElement('div');
                user.className = 'reel-user';
                user.innerHTML = '@sofia123 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="display:inline-block;margin-left:4px;vertical-align:middle;"><polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon><polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon></svg>';
                
                const acts = document.createElement('div');
                acts.className = 'reel-actions';
                
                // Like button with heart icon
                const like = document.createElement('button');
                like.className = 'reel-like';
                like.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>`;
                
                // Comment button
                const comment = document.createElement('button');
                comment.className = 'reel-comment';
                comment.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>`;
                
                // Donate button with gift icon
                const donate = document.createElement('button');
                donate.className = 'reel-donate';
                donate.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 12 20 22 4 22 4 12"></polyline>
                    <rect x="2" y="7" width="20" height="5"></rect>
                    <line x1="12" y1="22" x2="12" y2="7"></line>
                    <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
                    <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
                </svg>`;
                
                like.onclick = e => {
                    e.stopPropagation();
                    like.classList.toggle('liked');
                };
                
                comment.onclick = e => {
                    e.stopPropagation();
                    openCommentModal(r.id, 'reel');
                };
                
                donate.onclick = e => {
                    e.stopPropagation();
                    document.getElementById('openDonate').click();
                };
                
                acts.append(like, comment, donate);
                overlay.append(user, acts);
                wrap.append(video, overlay);
                grid.append(wrap);

                // Set up intersection observer for autoplay
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            // Video is visible, start playing
                            video.play().catch(() => {
                                // Autoplay failed, user interaction required
                                console.log('Autoplay prevented for video:', r.id);
                            });
                            overlay.style.opacity = '0.7';
                        } else {
                            // Video is not visible, pause it
                            video.pause();
                            overlay.style.opacity = '1';
                        }
                    });
                }, {
                    threshold: 0.5 // Trigger when 50% of video is visible
                });
                
                observer.observe(wrap);
                
                // Show overlay permanently when paused, semi-transparent when playing
                video.addEventListener('play', () => {
                    overlay.style.opacity = '0.7';
                });
                video.addEventListener('pause', () => {
                    overlay.style.opacity = '1';
                });
                
                // Remove all click interactions - videos play automatically based on visibility
            });
        }

        // Photo Viewer Functions
        function openPhotoViewer(id) {
            const modal = document.getElementById('photoViewerModal');
            const feed = document.getElementById('photoFeed');
            feed.innerHTML = '';
            photos.forEach(photo => {
                const view = document.createElement('div');
                view.className = 'post-view';
                
                // Add username overlay
                const usernameOverlay = document.createElement('div');
                usernameOverlay.className = 'media-username';
                usernameOverlay.textContent = '@sofia123';
                view.appendChild(usernameOverlay);
                
                const img = document.createElement('img');
                img.className = 'post-media';
                img.src = photo.url;
                img.onload = () => {
                    img.style.width = 'auto';
                    img.style.height = 'auto';
                };
                view.appendChild(img);
                const actions = document.createElement('div');
                actions.className = 'post-actions';
                const likeBtn = document.createElement('button');
                likeBtn.className = 'like-btn';
                likeBtn.innerHTML = `<svg style="width:24px;height:24px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>`;
                likeBtn.onclick = (e) => {
                    e.stopPropagation();
                    likeBtn.classList.toggle('liked');
                };
                const donateBtn = document.createElement('button');
                donateBtn.className = 'donate-btn';
                donateBtn.textContent = 'Donate';
                donateBtn.onclick = (e) => {
                    e.stopPropagation();
                    document.getElementById('openDonate').click();
                };
                actions.appendChild(likeBtn);
                actions.appendChild(donateBtn);
                view.appendChild(actions);
                feed.appendChild(view);
            });
            modal.style.display = 'flex';
            feed.scrollTo(0, (id - 1) * window.innerHeight);
        }

        function closePhotoViewer() {
            document.getElementById('photoViewerModal').style.display = 'none';
        }

        // Updated Reel Viewer Functions
        function openReelViewer(id) {
            const modal = document.getElementById('reelViewerModal');
            modal.style.display = 'flex';
            
            const feed = document.getElementById('reelFeed');
            feed.innerHTML = '';
            
            reels.forEach(r => {
                const v = document.createElement('div');
                v.className = 'post-view';
                
                const u = document.createElement('div');
                u.className = 'media-username';
                u.textContent = '@sofia123';
                
                const video = document.createElement('video');
                video.className = 'post-media';
                video.src = r.url;
                video.controls = true;
                video.autoplay = true;
                video.loop = true;
                video.style.maxWidth = '100%';
                video.style.maxHeight = '80vh';
                video.style.objectFit = 'contain';
                
                const acts = document.createElement('div');
                acts.className = 'post-actions overlay';
                
                const like = document.createElement('button');
                like.className = 'like-btn';
                like.innerHTML = `<svg style="width:24px;height:24px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>`;
                
                const don = document.createElement('button');
                don.className = 'donate-btn';
                don.textContent = 'Donate';
                
                like.onclick = () => like.classList.toggle('liked');
                don.onclick = () => document.getElementById('openDonate').click();
                
                acts.append(like, don);
                v.append(u, video, acts);
                feed.append(v);
            });
            
            feed.scrollTo(0, (id - 1) * window.innerHeight);
        }

        function closeReelViewer() {
            document.getElementById('reelViewerModal').style.display = 'none';
        }

        // New functions for menu and subscription modal
        function toggleMenu() {
            const menu = document.querySelector('.menu');
            const hamburger = document.querySelector('.hamburger');
            menu.classList.toggle('active');
            hamburger.classList.toggle('active');
            
            // Close menu when clicking outside
            if (menu.classList.contains('active')) {
                document.addEventListener('click', closeMenuOnClickOutside);
            } else {
                document.removeEventListener('click', closeMenuOnClickOutside);
            }
        }

        function closeMenuOnClickOutside(event) {
            const menu = document.querySelector('.menu');
            const hamburger = document.querySelector('.hamburger');
            
            if (!menu.contains(event.target) && !hamburger.contains(event.target)) {
                menu.classList.remove('active');
                hamburger.classList.remove('active');
                document.removeEventListener('click', closeMenuOnClickOutside);
            }
        }

        function openSubscribeModal() {
            document.getElementById('subscriptionModal').style.display = 'flex';
        }

        function closeSubscribeModal() {
            document.getElementById('subscriptionModal').style.display = 'none';
        }

        function subscribe() {
            const selectedPlan = document.querySelector('input[name="plan"]:checked').value;
            alert(`You have subscribed to the ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} Plan! Thank you!`);
            closeSubscribeModal();
        }

        function switchTab(tabName) {
            // Close menu when a tab is selected
            document.querySelector('.menu').classList.remove('active');
            document.querySelector('.hamburger').classList.remove('active');
            
            // Hide all content
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate the selected tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Show the selected content
            if (tabName === 'photos') {
                document.getElementById('photos-content').classList.add('active');
            } else if (tabName === 'reels') {
                document.getElementById('reels-content').classList.add('active');
            } else if (tabName === 'exclusive') {
                document.getElementById('exclusive-content').classList.add('active');
            } else if (tabName === 'chat') {
                document.getElementById("openChat").click();
            } else {
                alert(`The ${tabName} section is coming soon!`);
            }
        }

        /* Tabs */
        document.querySelectorAll(".tab-btn").forEach(b => {
            b.onclick = () => {
                document.querySelectorAll(".tab-btn").forEach(x => x.classList.remove("active"));
                document.querySelectorAll(".content").forEach(c => c.classList.remove("active"));
                b.classList.add("active");
                switchTab(b.dataset.tab);
            };
        });

        /* Chat */
        const chatScreen = document.getElementById("chatScreen");
        const openChat = document.getElementById("openChat");
        const backToMain = document.getElementById("backToMain");
        const chatMessages = document.getElementById("chatMessages");
        const chatInput = document.getElementById("chatInput");
        const sendMessage = document.getElementById("sendMessage");

        function addMessage(text, sender = "creator") {
            const wrapper = document.createElement("div");
            wrapper.className = "msg-wrapper";
            if (sender === "creator") wrapper.style.alignItems = "flex-start";
            const msg = document.createElement("div");
            msg.className = "msg " + (sender === "creator" ? "creator-msg" : "user-msg");
            msg.textContent = text;
            wrapper.appendChild(msg);
            chatMessages.appendChild(wrapper);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return wrapper;
        }

        function addStoryReplyMessage(storyImage, replyText, sender = "user") {
            const wrapper = document.createElement("div");
            wrapper.className = "msg-wrapper";
            if (sender === "creator") wrapper.style.alignItems = "flex-start";
            
            const msg = document.createElement("div");
            msg.className = "msg story-reply-msg " + (sender === "creator" ? "creator-msg" : "user-msg");
            
            // Create story preview container
            const storyPreview = document.createElement("div");
            storyPreview.className = "story-preview";
            storyPreview.style.cssText = `
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 8px 12px;
                background: ${sender === "creator" ? "rgba(0,0,0,0.08)" : "rgba(255,255,255,0.15)"};
                border-radius: 12px;
                margin-bottom: 8px;
                border-left: 3px solid #0095f6;
                cursor: pointer;
                transition: all 0.2s ease;
                border: 1px solid ${sender === "creator" ? "rgba(0,0,0,0.1)" : "rgba(255,255,255,0.2)"};
            `;
            
            // Add click handler to reopen story
            storyPreview.onclick = () => {
                // Find which story this image belongs to
                const storyIndex = Array.from(storyImages).findIndex(img => img.src === storyImage);
                if (storyIndex !== -1) {
                    // Close chat and open story
                    backToMain.click();
                    setTimeout(() => {
                        storyModal.style.display = "flex";
                        createBars();
                        showStory(storyIndex);
                        start();
                    }, 100);
                }
            };
            
            // Add hover effect
            storyPreview.onmouseenter = () => {
                storyPreview.style.background = sender === "creator" ? "rgba(0,0,0,0.12)" : "rgba(255,255,255,0.25)";
                storyPreview.style.transform = "scale(1.02)";
            };
            storyPreview.onmouseleave = () => {
                storyPreview.style.background = sender === "creator" ? "rgba(0,0,0,0.08)" : "rgba(255,255,255,0.15)";
                storyPreview.style.transform = "scale(1)";
            };
            
            // Add story image with proper sizing and styling
            const imgPreview = document.createElement("img");
            imgPreview.src = storyImage;
            imgPreview.style.cssText = `
                width: 48px;
                height: 48px;
                border-radius: 8px;
                object-fit: cover;
                border: 2px solid ${sender === "creator" ? "rgba(0,0,0,0.1)" : "rgba(255,255,255,0.3)"};
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            `;
            
            // Add story info container
            const storyInfo = document.createElement("div");
            storyInfo.style.cssText = "display: flex; flex-direction: column; gap: 2px;";
            
            // Add "Story" label
            const storyLabel = document.createElement("div");
            storyLabel.textContent = "Story";
            storyLabel.style.cssText = `
                font-size: 12px;
                font-weight: 600;
                color: ${sender === "creator" ? "#666" : "rgba(255,255,255,0.9)"};
                text-transform: uppercase;
                letter-spacing: 0.5px;
            `;
            
            // Add story timestamp/indicator
            const storyTime = document.createElement("div");
            storyTime.textContent = "Tap to view";
            storyTime.style.cssText = `
                font-size: 10px;
                color: ${sender === "creator" ? "#999" : "rgba(255,255,255,0.7)"};
                font-style: italic;
            `;
            
            storyInfo.appendChild(storyLabel);
            storyInfo.appendChild(storyTime);
            
            storyPreview.appendChild(imgPreview);
            storyPreview.appendChild(storyInfo);
            
            // Add reply text with better styling
            const replyTextDiv = document.createElement("div");
            replyTextDiv.textContent = replyText;
            replyTextDiv.style.cssText = `
                margin-top: 4px;
                line-height: 1.4;
                font-size: 15px;
            `;
            
            msg.appendChild(storyPreview);
            msg.appendChild(replyTextDiv);
            wrapper.appendChild(msg);
            chatMessages.appendChild(wrapper);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return wrapper;
        }

        let lastUserMessageWrapper = null; // Track the last user message
        let currentSeenElement = null; // Track current "seen" message

        function addSeen(wrapper) {
            // Remove any existing "seen" message
            if (currentSeenElement) {
                currentSeenElement.remove();
                currentSeenElement = null;
            }
            
            const seen = document.createElement("div");
            seen.className = "seen";
            seen.textContent = "Seen";
            wrapper.appendChild(seen);
            currentSeenElement = seen; // Track this "seen" element
            lastUserMessageWrapper = wrapper; // Update last user message tracker
        }

        function sendStoryReplyToChat(storyImage, replyText) {
            // Hide main header when chat is opened
            document.querySelector('.header').style.display = 'none';
            
            chatScreen.style.display = "flex";
            document.querySelector(".main-screen").style.display = "none";
            
            // Remove any existing "seen" message
            removeExistingSeen();
            
            // Add the story reply message
            const wrapper = addStoryReplyMessage(storyImage, replyText, "user");
            lastUserMessageWrapper = wrapper; // Track this as the last user message
            
            // Simulate creator response after a delay
            setTimeout(() => {
                // Only add "seen" to the most recent user message (story reply)
                addSeen(lastUserMessageWrapper);
                const typingIndicator = showTyping();
                setTimeout(() => {
                    typingIndicator.remove();
                    addMessage("Thanks for replying to my story! 😊", "creator");
                }, 2000);
            }, 1500);
        }

        function removeExistingSeen() {
            // Remove any existing "seen" message when user sends a new message
            if (currentSeenElement) {
                currentSeenElement.remove();
                currentSeenElement = null;
            }
        }
        function showTyping() {
            const typing = document.createElement("div");
            typing.className = "typing";
            typing.textContent = "Sofia is typing...";
            chatMessages.appendChild(typing);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return typing;
        }
        openChat.onclick = () => {
            // Hide main header when chat is opened
            document.querySelector('.header').style.display = 'none';
            
            chatScreen.style.display = "flex";
            document.querySelector(".main-screen").style.display = "none";
            chatMessages.innerHTML = "";
            setTimeout(() => addMessage("Welcome to my chat! 💬", "creator"), 400);
        };
        backToMain.onclick = () => {
            // Show main header again when returning from chat
            document.querySelector('.header').style.display = 'flex';
            
            chatScreen.style.display = "none";
            document.querySelector(".main-screen").style.display = "block";
        };
        sendMessage.onclick = () => {
            const text = chatInput.value.trim();
            if (text) {
                // Remove any existing "seen" message when user sends a new message
                removeExistingSeen();
                
                const wrapper = addMessage(text, "user");
                lastUserMessageWrapper = wrapper; // Track this as the last user message
                chatInput.value = "";
                
                setTimeout(() => {
                    // Only add "seen" to the most recent user message
                    addSeen(lastUserMessageWrapper);
                    const typingIndicator = showTyping();
                    setTimeout(() => {
                        typingIndicator.remove();
                        const reply = addMessage("Check this out 👉 https://mywebsite.com", "creator");
                        reply.querySelector(".msg").innerHTML = 'Check this out 👉 <a href="https://mywebsite.com" target="_blank">https://mywebsite.com</a>';
                    }, 3000);
                }, 2000);
            }
        };
        chatInput.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage.click(); });

        /* Donation Modals */
        const donateModal = document.getElementById("chooseMethodModal");
        const btcDonateModal = document.getElementById("btcDonateModal");
        const openDonate = document.getElementById("openDonate");
        const closeDonate = document.getElementById("closeDonate");
        const openBtcDonate = document.getElementById("openBtcDonate");
        const closeBtcDonate = document.getElementById("closeBtcDonate");
        const backToDonate = document.getElementById("backToDonate");
        const copyBtcAddress = document.getElementById("copyBtcAddress");
        const donateBtcNow = document.getElementById("donateBtcNow");
        const btcAddress = document.getElementById("btcAddress").textContent.trim();

        openDonate.onclick = () => donateModal.style.display = "flex";
        closeDonate.onclick = () => donateModal.style.display = "none";
        openBtcDonate.onclick = () => {
            donateModal.style.display = "none";
            btcDonateModal.style.display = "flex";
        };
        closeBtcDonate.onclick = () => btcDonateModal.style.display = "none";
        backToDonate.onclick = () => {
            btcDonateModal.style.display = "none";
            donateModal.style.display = "flex";
        };
        copyBtcAddress.onclick = () => {
            navigator.clipboard.writeText(btcAddress).then(() => showStatus("Address copied! 📋", "success")).catch(() => showStatus("Failed to copy", "error"));
        };
        donateBtcNow.onclick = () => {
            window.open("https://www.blockchain.com/explorer/addresses/btc/" + btcAddress, "_blank");
            btcDonateModal.style.display = "none";
        };
        function showStatus(msg, type) {
            const s = document.getElementById("statusMessage");
            s.textContent = msg;
            s.className = "status-message status-" + type;
            s.style.display = "block";
            setTimeout(() => s.style.display = "none", 3000);
        }

        /* Stories */
        const profilePic = document.getElementById("profilePic");
        const storyModal = document.getElementById("storyModal");
        const storyContainer = document.getElementById("storyContainer");
        const storyCloseBtn = document.getElementById("storyCloseBtn");
        const prevStoryBtn = document.getElementById("prevStoryBtn");
        const nextStoryBtn = document.getElementById("nextStoryBtn");
        const storyTapLeft = document.getElementById("storyTapLeft");
        const storyTapRight = document.getElementById("storyTapRight");
        const storyImages = document.querySelectorAll(".story-image");
        const progressBars = document.getElementById("progressBars");
        const storyCount = document.getElementById("storyCount");
        const replyInput = document.getElementById("replyInput");
        const sendStoryBtn = document.getElementById("sendStoryBtn");
        const likeStoryBtn = document.getElementById("likeStoryBtn");
        let currentStory = 0, timer, total = storyImages.length;
        const duration = 10000;
        let isLiked = false;

        function createBars() {
            progressBars.innerHTML = "";
            storyImages.forEach(() => {
                let b = document.createElement("div");
                b.className = "progress-bar";
                let f = document.createElement("div");
                f.className = "progress-bar-fill";
                b.appendChild(f);
                progressBars.appendChild(b);
            });
        }
        function showStory(i) {
            clearTimeout(timer);
            storyImages.forEach(im => im.classList.remove("active"));
            storyImages[i].classList.add("active");
            let fills = document.querySelectorAll(".progress-bar-fill");
            fills.forEach((f, j) => {
                f.style.transition = "none";
                f.style.width = j < i ? "100%" : "0%";
            });
            void progressBars.offsetWidth;
            fills[i].style.transition = `width ${duration}ms linear`;
            requestAnimationFrame(() => fills[i].style.width = "100%");
            storyCount.textContent = `${i + 1}/${total}`;
            currentStory = i;
            isLiked = false;
            likeStoryBtn.classList.remove("liked");
            updateNav();
        }
        function updateNav() {
            prevStoryBtn.classList.toggle("visible", currentStory > 0);
            nextStoryBtn.classList.toggle("visible", currentStory < total - 1);
        }
        function start() {
            timer = setTimeout(() => {
                if (currentStory < total - 1) {
                    showStory(currentStory + 1);
                    start();
                } else closeStory();
            }, duration);
        }
        function closeStory() {
            clearTimeout(timer);
            storyModal.style.display = "none";
            currentStory = 0;
            replyInput.value = "";
            sendStoryBtn.classList.remove("visible");
        }
        profilePic.onclick = () => {
            storyModal.style.display = "flex";
            createBars();
            showStory(0);
            start();
        };
        storyCloseBtn.onclick = (e) => {
            e.preventDefault();
            e.stopPropagation();
            closeStory();
        };
        
        // Also add event listener as backup
        storyCloseBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            closeStory();
        });
        
        // Add tap area navigation
        storyTapLeft.onclick = () => {
            if (currentStory > 0) {
                clearTimeout(timer);
                showStory(currentStory - 1);
                start();
            }
        };
        
        storyTapRight.onclick = () => {
            if (currentStory < total - 1) {
                clearTimeout(timer);
                showStory(currentStory + 1);
                start();
            } else {
                closeStory();
            }
        };
        
        replyInput.oninput = () => sendStoryBtn.classList.toggle("visible", !!replyInput.value.trim());
        
        // Add Enter key functionality to story reply input
        replyInput.addEventListener("keypress", e => { 
            if (e.key === "Enter" && replyInput.value.trim()) {
                sendStoryBtn.click();
            }
        });
        
        sendStoryBtn.onclick = () => {
            if (replyInput.value.trim()) {
                const replyText = replyInput.value.trim();
                const currentStoryImage = storyImages[currentStory].src;
                
                // Clear input and hide button immediately
                replyInput.value = "";
                sendStoryBtn.classList.remove("visible");
                
                // Close story modal
                closeStory();
                
                // Small delay to ensure smooth transition
                setTimeout(() => {
                    sendStoryReplyToChat(currentStoryImage, replyText);
                }, 100);
            }
        };
        likeStoryBtn.onclick = () => {
            isLiked = !isLiked;
            likeStoryBtn.classList.toggle("liked", isLiked);
        };
        prevStoryBtn.onclick = () => {
            if (currentStory > 0) {
                clearTimeout(timer);
                showStory(currentStory - 1);
                start();
            }
        };
        nextStoryBtn.onclick = () => {
            if (currentStory < total - 1) {
                clearTimeout(timer);
                showStory(currentStory + 1);
                start();
            } else closeStory();
        };
    </script>
</body>
</html>
